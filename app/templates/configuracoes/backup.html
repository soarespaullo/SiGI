{% extends "base.html" %}
{% block title %}Backup do Sistema{% endblock %}

{% block content %}
<div class="container mt-4">

  <!-- Botão de voltar alinhado à direita -->
  <div class="mb-3 d-flex justify-content-end">
    <a href="{{ url_for('configuracoes.configuracoes') }}" class="btn btn-secondary" title="Voltar para Configurações">
      <i class="bi bi-arrow-left-circle"></i>
    </a>
  </div>

  <h2><i class="bi bi-hdd-network text-success"></i> Backup do Sistema</h2>

  <div class="row g-4">
    <!-- Gerar Backup -->
    <div class="col-md-6">
      <div class="card shadow-sm border-0 h-100">
        <div class="card-header bg-success text-white">
          <i class="bi bi-download"></i> Gerar Backup
        </div>
        <div class="card-body text-center">
          <form method="POST" action="{{ url_for('configuracoes.backup.gerar_backup') }}">
            <input type="hidden" name="csrf_token" value="{{ csrf_token() }}">
            <button type="submit" class="btn btn-outline-success btn-lg">
              <i class="bi bi-download"></i> Gerar Backup
            </button>
          </form>
          <p class="mt-3 text-muted small">
            O backup será baixado em formato <code>.zip</code> contendo o arquivo <code>.sql</code>.
          </p>
        </div>
      </div>
    </div>

    <!-- Instruções de Restauração -->
    <div class="col-md-6">
      <div class="card shadow-sm border-0 h-100">
        <div class="card-header bg-info text-white">
          <i class="bi bi-info-circle"></i> Como Restaurar Manualmente
        </div>
        <div class="card-body">
          <p>
            Para restaurar o backup, utilize o arquivo <code>.sql</code> extraído do <code>.zip</code> e rode o comando abaixo diretamente no servidor:
          </p>
          <pre class="bg-light p-2 border rounded">
mysql -h localhost -P 3306 -u sigi_user -p sigi_db < sigi_db_backup_07-01-2026.sql
          </pre>
          <p class="text-muted small">
            • Substitua <code>sigi_user</code>, <code>sigi_db</code> e o nome do arquivo conforme sua configuração.<br>
            • O sistema não executa a restauração automaticamente para evitar riscos de perda de dados.
          </p>
        </div>
      </div>
    </div>
  </div>
</div>
{% endblock %}
